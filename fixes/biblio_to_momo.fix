unless any_match(status, public)
    reject()
end

# id
cp(_id, r.id)
prepend(r.id, 'biblio:')
cp(r.id, r._id)

# collection
add(r.collection.$append, biblio)

# type
cp(type, r.type)
lookup(r.type, biblio_type_mapping.csv, delete: 1)
unless exists(r.type)
    reject()
end

# title
cp(title, r.title)

# author
cp(author.*.name, r.metadata.author.$append.name)

# abstract
# TODO abstract lang
cp(abstract.*, r.metadata.abstract.$append.text)
set(r.metadata.abstract.*.lang, und)

# doi
cp(doi, r.metadata.doi)

# isbn
cp(isbn, r.metadata.isbn)

# ensure metadata hash exists
unless exists(r.metadata)
    set_hash(r.metadata)
end

# recs
cp(r, recs.$append)
retain(recs)